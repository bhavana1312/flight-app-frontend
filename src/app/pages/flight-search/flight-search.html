<div class="search-container">
  <h2>Search Flights</h2>

  <form [formGroup]="searchForm" (ngSubmit)="onSearch()">
    <div class="field-wrapper" (focusin)="onFocus('from')" (focusout)="onBlur('from')" tabindex="-1">

      <label>From</label>

      <input type="text" formControlName="fromPlace" (input)="filterCities(searchForm.value.fromPlace,'from')"
        (keydown)="handleKey($event,'from')" />

      <ul class="dropdown" *ngIf="filteredFrom.length>0">
        <li *ngFor="let city of filteredFrom;let i=index" [class.active]="i===activeFromIndex"
          (mousedown)="selectCity(city,'from')">{{city}}
        </li>
      </ul>
    </div>


    <div class="field-wrapper" (focusin)="onFocus('to')" (focusout)="onBlur('to')" tabindex="-1">

      <label>To</label>

      <input type="text" formControlName="toPlace" (input)="filterCities(searchForm.value.toPlace,'to')"
        (keydown)="handleKey($event,'to')" />

      <ul class="dropdown" *ngIf="filteredTo.length>0">
        <li *ngFor="let city of filteredTo;let i=index" [class.active]="i===activeToIndex"
          (mousedown)="selectCity(city,'to')">{{city}}
        </li>
      </ul>
    </div>



    <div class="field-wrapper">
      <label>Journey Date</label>
      <input type="date" formControlName="journeyDate" [min]="today" />
    </div>


    <button type="submit" [disabled]="searchForm.invalid">
      Search Flights
    </button>
  </form>
</div>

<div class="popular-container" *ngIf="flights.length === 0">
  <h3>Popular Destinations</h3>

  <div class="popular-grid">
    <div class="destination-card">
      <img
        src="https://images.unsplash.com/photo-1551161242-b5af797b7233?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8aHlkZXJhYmFkfGVufDB8fDB8fHww" />
      <span>Hyderabad</span>
    </div>

    <div class="destination-card">
      <img
        src="https://images.unsplash.com/photo-1675589412450-571c4a5afe6e?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTl8fGJlbmdhbHVydXxlbnwwfHwwfHx8MA%3D%3D" />
      <span>Bengaluru</span>
    </div>

    <div class="destination-card">
      <img
        src="https://images.unsplash.com/photo-1582510003544-4d00b7f74220?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTl8fGJlbmdhbHVydXxlbnwwfHwwfHx8MA%3D%3D" />
      <span>Chennai</span>
    </div>

    <div class="destination-card">
      <img
        src="https://images.unsplash.com/photo-1595658658481-d53d3f999875?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTl8fGJlbmdhbHVydXxlbnwwfHwwfHx8MA%3D%3D" />
      <span>Mumbai</span>
    </div>
  </div>
</div>

<div class="results-container" *ngIf="flights.length > 0">
  <h3>Available Flights</h3>

  <div class="flight-card" *ngFor="let flight of flights">
    <div class="flight-header">
      <div class="airline">
        <span>{{ flight.airlineName }}</span>
      </div>
      <div class="price">
        ₹{{ flight.lowestPrice }}
      </div>
    </div>

    <div class="flight-body">
      <div>
        <strong>{{ flight.fromPlace }}</strong><br />
        {{ flight.departureDateTime | date:'short' }}
      </div>

      <div class="arrow">→</div>

      <div>
        <strong>{{ flight.toPlace }}</strong><br />
        {{ flight.arrivalDateTime | date:'short' }}
      </div>
    </div>

    <div class="flight-footer">
      <span>Seats: {{ flight.availableSeats }}</span>
      <button [routerLink]="['/booking', flight.flightId]">
        Book
      </button>
    </div>
  </div>
</div>